{% extends 'firstApp/base.html' %}

{% block content %}
<h2 class="mb-4">Checkout</h2>
<div class="row">
    <div class="col-md-8">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Shipping & Payment</h5>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    <div class="row g-3">
                        {% if form.non_field_errors %}
                        <div class="col-12">
                            <div class="alert alert-danger">
                                {{ form.non_field_errors }}
                            </div>
                        </div>
                        {% endif %}
                        <div class="col-md-6 mb-3">
                            <label class="form-label">House Number <span class="text-danger">*</span></label>
                            {{ form.house_number }}
                            {% if form.house_number.errors %}
                            <div class="text-danger small">{{ form.house_number.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Pincode <span class="text-danger">*</span></label>
                            {{ form.pincode }}
                            {% if form.pincode.errors %}
                            <div class="text-danger small">{{ form.pincode.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-12 mb-3">
                            <label class="form-label">Address Line 1 (Area/Colony) <span
                                    class="text-danger">*</span></label>
                            {{ form.address_line1 }}
                            {% if form.address_line1.errors %}
                            <div class="text-danger small">{{ form.address_line1.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-12 mb-3">
                            <label class="form-label">Address Line 2 (Optional)</label>
                            {{ form.address_line2 }}
                            {% if form.address_line2.errors %}
                            <div class="text-danger small">{{ form.address_line2.errors.0 }}</div>
                            {% endif %}
                        </div>
                        <div class="col-12 mb-3">
                            <label class="form-label">City</label>
                            {{ form.city }}
                            {% if form.city.errors %}
                            <div class="text-danger small">{{ form.city.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Payment Method</label>
                        {% for radio in form.payment_method %}
                        <div class="form-check">
                            {{ radio.tag }}
                            <label class="form-check-label" for="{{ radio.id_for_label }}">
                                {{ radio.choice_label }}
                            </label>
                        </div>
                        {% endfor %}
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg w-100">Place Order</button>
                    <p class="text-muted mt-2 small text-center">By placing this order, you agree to our terms. Final
                        delivery charges will be confirmed by our team.</p>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Order Summary</h5>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush mb-3">
                    {% for item in cart.items.all %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="my-0">{{ item.product.name }}</h6>
                            <small class="text-muted">Qty: {{ item.quantity }}</small>
                        </div>
                        <!-- Prices hidden per requirement "No price shown to customer yet" or just finalized total? 
                             If "User Features" says "Name, Description, Images...", it doesn't explicitly hide price there.
                             But "Order Placement Flow -> No price shown to customer yet".
                             I'll hide prices here to be safe and robust to the request. -->
                        <span class="text-muted">--</span>
                    </li>
                    {% endfor %}
                </ul>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    Final price (including delivery charges based on distance) will be confirmed by our team via
                    Call/SMS after you place the order.
                </div>

                <div class="d-flex justify-content-between mb-2">
                    <span>Delivery Charge</span>
                    <span>Calculated based on distance</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between mb-3">
                    <span class="fw-bold fs-5">Total Payable</span>
                    <span class="fw-bold fs-5">To be confirmed</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}