<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}SSElectricals Admin{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom Admin Theme CSS -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/admin-theme.css' %}?v=18.0">
    {% block extra_css %}{% endblock %}

</head>

<body>

    <div class="sidebar">
        <div class="brand">
            <i class="fas fa-bolt"></i> Admin Panel
        </div>
        <a href="{% url 'admin_dashboard' %}"
            class="{% if request.resolver_match.url_name == 'admin_dashboard' %}active{% endif %}">
            <i class="fas fa-tachometer-alt me-2"></i> Dashboard
        </a>
        <a href="{% url 'admin_product_list' %}"
            class="{% if 'product' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-box me-2"></i> Products
        </a>
        <a href="{% url 'admin_order_list' %}"
            class="{% if 'order' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-shopping-cart me-2"></i> Orders
        </a>
        <a href="{% url 'admin_appointment_list' %}"
            class="{% if 'appointment' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-calendar-check me-2"></i> Appointments
        </a>
        <a href="{% url 'admin_service_prices' %}"
            class="{% if 'service_price' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-tag me-2"></i> Service Pricing
        </a>
        <a href="{% url 'admin_service_types' %}"
            class="{% if 'service_type' in request.resolver_match.url_name %}active{% endif %}"
            style="padding-left: 35px;">
            <i class="fas fa-cogs me-2"></i> Service Types
        </a>
        <a href="{% url 'admin_distance_zones' %}"
            class="{% if 'distance_zone' in request.resolver_match.url_name %}active{% endif %}"
            style="padding-left: 35px;">
            <i class="fas fa-map-marker-alt me-2"></i> Distance Zones
        </a>
        <a href="{% url 'admin_user_list' %}"
            class="{% if 'user' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-users me-2"></i> Users
        </a>
        <a href="{% url 'admin_analytics' %}"
            class="{% if 'analytics' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-chart-line me-2"></i> Analytics
        </a>
        <a href="{% url 'admin_daily_sales' %}"
            class="{% if 'sales' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-rupee-sign me-2"></i> Daily Sales
        </a>
        <a href="{% url 'admin_daily_expenses' %}"
            class="{% if 'expenses' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-money-bill-wave me-2"></i> Expenses
        </a>
        <a href="{% url 'admin_reviews_list' %}"
            class="{% if 'review' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-star me-2"></i> Reviews
        </a>
        <a href="{% url 'receipt_list' %}"
            class="{% if 'receipt' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-receipt me-2"></i> Offline Receipts
        </a>
        <a href="{% url 'admin_notifications_list' %}"
            class="{% if 'notification' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-bell me-2"></i> Notifications
        </a>
        <a href="{% url 'admin_announcements_list' %}"
            class="{% if 'announcement' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-bullhorn me-2"></i> Announcements
        </a>
        <a href="{% url 'admin_electrician_list' %}"
            class="{% if 'electrician' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-hard-hat me-2"></i> Electricians
        </a>
        <a href="{% url 'admin_warranty_list' %}"
            class="{% if 'warranty' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-shield-alt me-2"></i> Warranties
        </a>
        <a href="{% url 'admin_appointment_book' %}"
            class="{% if 'appointment_book' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-calendar-plus me-2"></i> Book Appointment
        </a>
        <a href="{% url 'admin_activity_log' %}"
            class="{% if 'log' in request.resolver_match.url_name %}active{% endif %}">
            <i class="fas fa-history me-2"></i> Logs
        </a>
        <hr style="border-color: #555;">
        <a href="{% url 'home' %}">
            <i class="fas fa-globe me-2"></i> View Site
        </a>
        <form action="{% url 'logout' %}" method="post" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-link text-decoration-none p-0 text-start w-100"
                style="color: #ccc; padding: 15px 20px !important;">
                <i class="fas fa-sign-out-alt me-2"></i> Logout
            </button>
        </form>
    </div>

    <div class="main-content">
        <!-- Top Navbar (Optional, for now just content) -->
        <div class="container-fluid">
            {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
            {% endif %}

            {% block content %}{% endblock %}
        </div>
    </div>

    <!-- Theme Toggle Button -->
    <button id="theme-toggle"
        class="btn btn-dark position-fixed bottom-0 end-0 m-4 rounded-circle shadow-lg d-flex align-items-center justify-content-center"
        style="width: 50px; height: 50px; z-index: 1050;">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Common Admin Scripts
        const toggleBtn = document.getElementById('theme-toggle');
        const body = document.body;
        const icon = toggleBtn.querySelector('i');

        // Check local storage or set default to LIGHT
        const currentTheme = localStorage.getItem('admin_theme');
        if (currentTheme === 'dark') {
            body.classList.add('dark-mode');
            icon.classList.replace('fa-moon', 'fa-sun');
            toggleBtn.classList.replace('btn-dark', 'btn-light');
        }

        toggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('admin_theme', 'dark');
                icon.classList.replace('fa-moon', 'fa-sun');
                toggleBtn.classList.replace('btn-dark', 'btn-light');
            } else {
                localStorage.setItem('admin_theme', 'light');
                icon.classList.replace('fa-sun', 'fa-moon');
                toggleBtn.classList.replace('btn-light', 'btn-dark');
            }
        });

        // Auto-dismiss success/info alerts after 5 seconds
        document.addEventListener('DOMContentLoaded', function () {
            const alerts = document.querySelectorAll('.alert-success, .alert-info');
            alerts.forEach(function (alert) {
                setTimeout(function () {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                }, 5000); // 5 seconds
            });
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>